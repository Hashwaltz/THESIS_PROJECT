{% extends 'hr/admin/admin_base.html' %}
{% block title %}HR Admin - Leave Requests{% endblock %}

{% block content %}
<main class="content-wrap">
  <header class="content-head">
    <h1>Leave Requests</h1>
  </header>

  <!-- Filter Form -->
  <div class="search-box">
    <form method="get" class="filter-form">
      <div class="fields">
        <div class="input-field">
          <label>Status</label>
          <select id="status" name="status">
            <option value="">All</option>
            <option value="Pending" {% if status_filter == "Pending" %}selected{% endif %}>Pending</option>
            <option value="Approved" {% if status_filter == "Approved" %}selected{% endif %}>Approved</option>
            <option value="Rejected" {% if status_filter == "Rejected" %}selected{% endif %}>Rejected</option>
          </select>
        </div>

        <div class="input-field">
          <label>&nbsp;</label> <!-- Spacer -->
          <button type="submit" class="submit">
            <span class="btnText">Filter</span>
            <i class="uil uil-filter"></i>
          </button>
        </div>
      </div>
    </form>
  </div>

  <!-- Leave Records Table -->
  <div class="table-container">
    <div class="centered-container">
      <table class="responsive-table">
        <caption><b>Leave List</b></caption>
        <thead>
          <tr>
            <th>Employee</th>
            <th>Leave Type</th>
            <th>Start Date</th>
            <th>End Date</th>
            <th>Reason</th>
            <th>Status</th>
            <th>Requested At</th>
          </tr>
        </thead>
        <tbody>
          {% for leave in leaves.items %}
          <tr>
            <td data-label="Employee">{{ leave.employee.get_full_name() }}</td>
            <td data-label="Leave Type">{{ leave.leave_type }}</td>
            <td data-label="Start Date">{{ leave.start_date.strftime('%Y-%m-%d') }}</td>
            <td data-label="End Date">{{ leave.end_date.strftime('%Y-%m-%d') }}</td>
            <td data-label="Reason">{{ leave.reason }}</td>
            <td data-label="Status">{{ leave.status }}</td>
            <td data-label="Requested At">{{ leave.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
          </tr>
          {% else %}
          <tr>
            <td colspan="7">No leave requests found.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>

      <!-- Pagination -->
      <div class="pagination">
        {% if leaves.has_prev %}
          <a href="{{ url_for('hr_admin_bp.view_leaves', page=leaves.prev_num, status=status_filter) }}">Previous</a>
        {% endif %}

        Page {{ leaves.page }} of {{ leaves.pages }}

        {% if leaves.has_next %}
          <a href="{{ url_for('hr_admin_bp.view_leaves', page=leaves.next_num, status=status_filter) }}">Next</a>
        {% endif %}
      </div>
    </div>
  </div>
</main>
{% endblock %}
