{% extends 'payroll/admin/payroll_admin_base.html' %}
{% block title %}Payroll Admin - Edit Payroll Period{% endblock %}

{% block content %}
<main class="content-wrap">
  <header class="content-head">
    <h1><b>Edit Payroll Period</b></h1>
  </header>

  <div class="payroll-container">
    <header>Payroll Period Details</header>

    <form method="POST" action="{{ url_for('payroll_admin.edit_payroll_period', period_id=payroll_period.id) }}" id="payrollForm">
      <div class="form first">
        <div class="details personal">
          <div class="fields">

            <!-- Payroll Period Name -->
            <div class="input-field">
              <label>Payroll Period Name</label>
              <input
                type="text"
                name="period_name"
                class="form-control"
                placeholder="e.g. October 1â€“15, 2025"
                value="{{ payroll_period.period_name }}"
                required
              />
            </div>

            <!-- Start Date -->
            <div class="input-field">
              <label>Start Date</label>
              <input
                type="date"
                name="start_date"
                class="form-control"
                value="{{ payroll_period.start_date.strftime('%Y-%m-%d') }}"
                required
              />
            </div>

            <!-- End Date -->
            <div class="input-field">
              <label>End Date</label>
              <input
                type="date"
                name="end_date"
                class="form-control"
                value="{{ payroll_period.end_date.strftime('%Y-%m-%d') }}"
                required
              />
            </div>

            <!-- Pay Date -->
            <div class="input-field">
              <label>Pay Date</label>
              <input
                type="date"
                name="pay_date"
                class="form-control"
                value="{{ payroll_period.pay_date.strftime('%Y-%m-%d') }}"
                required
              />
            </div>

            <!-- Status -->
            <div class="input-field">
            <label>Status</label>
            <select name="status" class="form-control" required>
                <option value="Open" {% if payroll_period.status == 'Open' %}selected{% endif %}>Open</option>
                <option value="Processing" {% if payroll_period.status == 'Processing' %}selected{% endif %}>Processing</option>
                <option value="Closed" {% if payroll_period.status == 'Closed' %}selected{% endif %}>Closed</option>
            </select>
            </div>
          </div>
        </div>

        <!-- Submit Button -->
        <button type="button" class="submit" id="savePayrollBtn">
          <span class="btnText">Update Payroll Period</span>
          <i class="uil uil-navigator"></i>
        </button>
      </div>
    </form>
  </div>
</main>

<!-- SweetAlert2 Confirmation -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
  const form = document.getElementById("payrollForm");
  const saveBtn = document.getElementById("savePayrollBtn");

  saveBtn.addEventListener("click", function (e) {
    e.preventDefault();

    Swal.fire({
      title: "Confirm Update",
      text: "Are you sure you want to update this payroll period?",
      icon: "question",
      showCancelButton: true,
      confirmButtonColor: "#3085d6",
      cancelButtonColor: "#d33",
      confirmButtonText: "Yes, update it!"
    }).then((result) => {
      if (result.isConfirmed) {
        form.submit();
      }
    });
  });
</script>
{% endblock %}
