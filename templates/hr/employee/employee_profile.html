{% extends "hr/employee/employee_base.html" %}
{% block title %}HR Employee - Edit Password{% endblock %}

{% block content %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />

<div class="content-wrap">
  <center>
    <div class="edit-container" style="max-width:600px; background:#fff; padding:30px; border-radius:10px; box-shadow:0 5px 15px rgba(0,0,0,0.1); margin-top:30px;">
      <header style="font-size:1.8em; font-weight:600; color:#4b84fe; margin-bottom:20px;">Change Password</header>
      <form method="POST" action="{{ url_for('employee.edit_password') }}" id="editProfileForm">

        <div class="input-field">
          <label>Email</label>
          <input type="email" name="email" value="{{ current_user.email }}" readonly />
        </div>

        <div class="input-field">
          <label>Password</label>
          <input type="password" name="password" id="password" placeholder="Enter new password" />
        </div>

        <button type="button" class="submit" id="saveProfileBtn" style="margin-top:15px; background:#4070f4; color:#fff; padding:12px 25px; border-radius:5px; border:none; font-weight:600; cursor:pointer;">
          Update Password
        </button>

      </form>
    </div>
  </center>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const saveBtn = document.getElementById("saveProfileBtn");
  const form = document.getElementById("editProfileForm");

  // SweetAlert confirmation before submit
  saveBtn.addEventListener("click", function (e) {
    e.preventDefault();
    Swal.fire({
      title: "Do you want to save the new password?",
      showCancelButton: true,
      confirmButtonText: "Save",
      cancelButtonText: "Cancel",
      confirmButtonColor: "#4e73df",
      cancelButtonColor: "#858796",
    }).then((result) => {
      if (result.isConfirmed) {
        form.submit();
      }
    });
  });

  // Show success message if flashed
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% for category, message in messages %}
      {% if category == 'success' %}
        Swal.fire({
          icon: 'success',
          title: 'Success!',
          text: '{{ message }}',
          confirmButtonColor: '#4e73df'
        });
      {% elif category == 'warning' %}
        Swal.fire({
          icon: 'warning',
          title: 'Warning!',
          text: '{{ message }}',
          confirmButtonColor: '#f0ad4e'
        });
      {% endif %}
    {% endfor %}
  {% endwith %}
});
</script>
{% endblock %}
